# DATA WAREHOUSE WITH REDSHIFT

## How-to Run This Repo
1. Create a Redshift cluster
2. Create database, username, and password in Redshift cluster
3. Create IAM Role with Redshift and S3 full access
4. Copy IAM key and secret key
4. Attach IAM Role in Redshift cluster
5. Copy Redshift cluster endpoint, database name, username, password, IAM key and secret key
6. Paste data in `dwh.cfg` file
7. run `python create_tables.py`
8. run `etl.py`

## Data Structure

`songdata`: 
* a subset of real data from the Million Song Dataset. Each file is in JSON format and contains metadata about a song and the artist of that song.
* S3 path: `s3://udacity-dend/song_data`
* Example:
```bazaar
{"num_songs": 1, "artist_id": "ARJIE2Y1187B994AB7", "artist_latitude": null, "artist_longitude": null, "artist_location": "", "artist_name": "Line Renaud", "song_id": "SOUPIRU12A6D4FA1E1", "title": "Der Kleine Dompfaff", "duration": 152.92036, "year": 0}
```

`logdata`: 
* consists of log files in JSON format generated by this event simulator based on the songs in the dataset above. These simulate app activity logs from an imaginary music streaming app based on configuration settings.
* S3 path: `s3://udacity-dend/log_data`
* S3 log data json path: `s3://udacity-dend/log_json_path.json` 
* Example:
![](log-data.png)

## Database Schema

### Staging Tables
`staging_events`: a staging table to pull log data from S3.
* artist, auth, first_name, gender, item_in_session,  last_name, length, 
level, location, method, page, registration, session_id, song,
status, ts, user_agent, user_id

`staging_songs`: a staging table to pull song data from S3.
* num_songs, artist_id, artist_name, artist_latitude, 
artist_longitude, artist_location, song_id, title, 
duration, year

### Fact Table
`songplays`: records in log data associated with song plays i.e. records with page NextSong
* songplay_id, start_time, user_id, level, song_id, artist_id, session_id, location, user_agent

### Dimension Tables
`users`: users in the app
* user_id, first_name, last_name, gender, level

`songs`: songs in music database
* song_id, title, artist_id, year, duration

`artists`: artists in music database
* artist_id, name, location, latitude, longitude

`time`: timestamps of records in songplays broken down into specific units
* start_time, hour, day, week, month, year, weekday

